<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Libros - iRevive</title>
    <style>
        body { font-family: -apple-system, sans-serif; background: #fff; color: #333; margin: 0; padding: 20px; }
        h1 { font-size: 22px; font-weight: 400; margin-bottom: 20px; }
        ul { list-style: none; padding: 0; }
        li { margin-bottom: 15px; }
        a { color: #007aff; text-decoration: none; display: block; padding: 10px; border-bottom: 1px solid #eee; }
        .icono { width: 40px; vertical-align: middle; margin-right: 10px; }
        .progreso { font-size: 12px; color: #999; }
        button { background: #f0f0f0; border: none; padding: 10px 20px; margin-top: 20px; cursor: pointer; border-radius: 5px; }
    </style>
    <script>
        var apiKey = 'TU_API_KEY'; // Reemplaza con tu API key
        var folderId = '1ToBUTJXyxNWO4pwoCsDHDUU5uRoX97zw'; // ID de carpeta libros

        function listarArchivos() {
            var xhr = new XMLHttpRequest();
            xhr.open('GET', 'https://www.googleapis.com/drive/v3/files?q=\'' + folderId + '\'+in+parents&key=' + apiKey + '&fields=files(id,name,mimeType)');
            xhr.onload = function() {
                if (xhr.status === 200) {
                    var data = JSON.parse(xhr.responseText);
                    var lista = document.getElementById('lista-libros');
                    data.files.forEach(function(file) {
                        var li = document.createElement('li');
                        var a = document.createElement('a');
                        a.href = 'https://drive.google.com/file/d/' + file.id + '/view';
                        a.target = '_blank';
                        a.innerHTML = '<img src="ico/libros/icon-libro1.png" alt="Icono" class="icono">' + file.name; // Usa tus íconos de /ico/libros/
                        li.appendChild(a);
                        
                        // Progreso
                        var prog = localStorage.getItem('progreso_libro_' + file.id);
                        if (prog) {
                            var span = document.createElement('span');
                            span.className = 'progreso';
                            span.textContent = ' (Progreso: ' + prog + ')';
                            li.appendChild(span);
                        }
                        
                        // Guardar progreso
                        var input = document.createElement('input');
                        input.type = 'number';
                        input.placeholder = 'Página';
                        input.style.width = '50px';
                        var btn = document.createElement('button');
                        btn.textContent = 'Guardar';
                        btn.onclick = (function(id) { return function() {
                            var val = input.value;
                            if (val) localStorage.setItem('progreso_libro_' + id, val);
                        }; })(file.id);
                        li.appendChild(input);
                        li.appendChild(btn);
                        
                        lista.appendChild(li);
                    });
                }
            };
            xhr.send();
        }
        window.onload = listarArchivos;
    </script>
</head>
<body>
    <h1>Libros</h1>
    <ul id="lista-libros"></ul>
    <button onclick="window.location.href='index.html'">Volver</button>
</body>
</html>